%% TradePulse trust boundaries and data flow constraints
flowchart TD
    subgraph Boundary0[Boundary 0: Public]
        clients[Clients]
    end

    subgraph Boundary1[Boundary 1: Edge]
        waf[Managed WAF]
    end

    subgraph Boundary2[Boundary 2: DMZ]
        gateway[Ingress Gateway]
        authn[Identity Federation Proxy]
        observability[Logging & SIEM Forwarder]
    end

    subgraph Boundary3[Boundary 3: Core Services]
        tradepulse_api[TradePulse API]
        service_mesh[Service Mesh mTLS]
        kafka[Kafka Cluster]
        postgres[PostgreSQL HA]
    end

    clients -->|HTTPS| waf
    waf -->|sanitised headers| gateway
    gateway -->|validated hosts| authn
    authn -->|JWT + mTLS| tradepulse_api
    tradepulse_api -->|id-tagged events| observability
    tradepulse_api --> service_mesh
    service_mesh --> kafka
    service_mesh --> postgres
